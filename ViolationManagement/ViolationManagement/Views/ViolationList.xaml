<Window x:Class="ViolationManagement.Views.ViolationList"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Quản lý vi phạm" Height="550" Width="950"
        WindowStartupLocation="CenterScreen" Background="#F8F9FA">

    <Window.Resources>
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Background" Value="#B71C1C"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Grid Grid.Row="0" Height="60" Margin="0,0,0,20">
            <Grid.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                    <GradientStop Color="#B71C1C" Offset="0"/>
                    <GradientStop Color="#B71C1A" Offset="1"/>
                </LinearGradientBrush>
            </Grid.Background>

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0,0,0">
                <TextBlock Text="📝" FontSize="20" Margin="0,0,10,0"/>
                <TextBlock Text="Quản lý vi phạm" Foreground="White" FontWeight="Bold" FontSize="18"/>
            </StackPanel>

            <StackPanel Orientation="Horizontal" Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,20,0">
                <Button Content="🏠 Trang chủ" Click="OpenHome" Style="{StaticResource ModernButton}" Margin="5,0"/>
                <Button Content="🚪 Đăng xuất" Click="Logout" Style="{StaticResource ModernButton}" Margin="5,0"/>
            </StackPanel>
        </Grid>

        <!-- DataGrid -->
        <Border Grid.Row="1" Background="White" CornerRadius="5" BorderBrush="#E0E0E0" BorderThickness="1">
            <DataGrid x:Name="dgViolations" AutoGenerateColumns="False" CanUserAddRows="False" IsReadOnly="True" SelectionMode="Single" Margin="0">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Biển số" Binding="{Binding PlateNumber}" Width="100"/>
                    <DataGridTextColumn Header="Loại vi phạm" Binding="{Binding ViolationType}" Width="100"/>
                    <DataGridTextColumn Header="Mô tả" Binding="{Binding Description}" Width="150"/>
                    <DataGridTextColumn Header="Địa điểm" Binding="{Binding Location}" Width="150"/>
                    <DataGridTextColumn Header="Ngày phạt" Binding="{Binding FineDate, StringFormat=dd/MM/yyyy}" Width="100"/>
                    <DataGridTextColumn Header="Số tiền phạt" Binding="{Binding FineAmount}" Width="100"/>
                    <DataGridTextColumn Header="Trạng thái" Binding="{Binding PaidStatusText}" Width="100"/>

                    <DataGridTemplateColumn Header="Hành động" Width="150">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Button x:Name="btnPay"
                        Content="Xác nhận thanh toán" 
                        Style="{StaticResource ModernButton}" 
                        Padding="8,2" 
                        Click="ConfirmPayment_Click"/>

                                    <TextBlock x:Name="txtPaid"
                           Text="Đã thanh toán" 
                           Foreground="Green" 
                           FontWeight="Bold" 
                           HorizontalAlignment="Center" 
                           VerticalAlignment="Center"
                           Visibility="Collapsed"/>
                                </Grid>

                                <DataTemplate.Triggers>
                                    <!-- Nếu PaidStatus là true -->
                                    <DataTrigger Binding="{Binding PaidStatus}" Value="True">
                                        <Setter TargetName="btnPay" Property="Visibility" Value="Collapsed"/>
                                        <Setter TargetName="txtPaid" Property="Visibility" Value="Visible"/>
                                    </DataTrigger>

                                    <!-- Nếu PaidStatus là false -->
                                    <DataTrigger Binding="{Binding PaidStatus}" Value="False">
                                        <Setter TargetName="btnPay" Property="Visibility" Value="Visible"/>
                                        <Setter TargetName="txtPaid" Property="Visibility" Value="Collapsed"/>
                                    </DataTrigger>
                                </DataTemplate.Triggers>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                </DataGrid.Columns>
            </DataGrid>
        </Border>
    </Grid>
</Window>
